var V=r=>{throw TypeError(r)};var j=(r,t,e)=>t.has(r)||V("Cannot "+e);var i=(r,t,e)=>(j(r,t,"read from private field"),e?e.call(r):t.get(r)),b=(r,t,e)=>t.has(r)?V("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(r):t.set(r,e),l=(r,t,e,s)=>(j(r,t,"write to private field"),s?s.call(r,e):t.set(r,e),e),g=(r,t,e)=>(j(r,t,"access private method"),e);import{S as $,p as A,s as W,q as N,t as ee,r as I,v as te,R as B}from"./index-DyUplI_S.js";import{Q as Z,u as se,a as re,e as oe,b as ne,c as ie,s as _,f as G,w as ae,g as ue,d as ce}from"./suspense-DDozuG3g.js";function J(r,t){const e=new Set(t);return r.filter(s=>!e.has(s))}function le(r,t,e){const s=r.slice(0);return s[t]=e,s}var E,m,w,Q,p,O,M,q,k,c,L,P,F,H,z,Y,he=(Y=class extends ${constructor(t,e,s){super();b(this,c);b(this,E);b(this,m);b(this,w);b(this,Q);b(this,p);b(this,O);b(this,M);b(this,q);b(this,k,[]);l(this,E,t),l(this,Q,s),l(this,w,[]),l(this,p,[]),l(this,m,[]),this.setQueries(e)}onSubscribe(){this.listeners.size===1&&i(this,p).forEach(t=>{t.subscribe(e=>{g(this,c,H).call(this,t,e)})})}onUnsubscribe(){this.listeners.size||this.destroy()}destroy(){this.listeners=new Set,i(this,p).forEach(t=>{t.destroy()})}setQueries(t,e){l(this,w,t),l(this,Q,e),A.batch(()=>{const s=i(this,p),o=g(this,c,F).call(this,i(this,w));l(this,k,o),o.forEach(a=>a.observer.setOptions(a.defaultedQueryOptions));const n=o.map(a=>a.observer),u=n.map(a=>a.getCurrentResult()),h=s.length!==n.length,v=n.some((a,C)=>a!==s[C]),f=h||v,S=f?!0:u.some((a,C)=>{const R=i(this,m)[C];return!R||!W(a,R)});!f&&!S||(f&&l(this,p,n),l(this,m,u),this.hasListeners()&&(f&&(J(s,n).forEach(a=>{a.destroy()}),J(n,s).forEach(a=>{a.subscribe(C=>{g(this,c,H).call(this,a,C)})})),g(this,c,z).call(this)))})}getCurrentResult(){return i(this,m)}getQueries(){return i(this,p).map(t=>t.getCurrentQuery())}getObservers(){return i(this,p)}getOptimisticResult(t,e){const s=g(this,c,F).call(this,t),o=s.map(n=>n.observer.getOptimisticResult(n.defaultedQueryOptions));return[o,n=>g(this,c,P).call(this,n??o,e),()=>g(this,c,L).call(this,o,s)]}},E=new WeakMap,m=new WeakMap,w=new WeakMap,Q=new WeakMap,p=new WeakMap,O=new WeakMap,M=new WeakMap,q=new WeakMap,k=new WeakMap,c=new WeakSet,L=function(t,e){return e.map((s,o)=>{const n=t[o];return s.defaultedQueryOptions.notifyOnChangeProps?n:s.observer.trackResult(n,u=>{e.forEach(h=>{h.observer.trackProp(u)})})})},P=function(t,e){return e?((!i(this,O)||i(this,m)!==i(this,q)||e!==i(this,M))&&(l(this,M,e),l(this,q,i(this,m)),l(this,O,N(i(this,O),e(t)))),i(this,O)):t},F=function(t){const e=new Map(i(this,p).map(o=>[o.options.queryHash,o])),s=[];return t.forEach(o=>{const n=i(this,E).defaultQueryOptions(o),u=e.get(n.queryHash);u?s.push({defaultedQueryOptions:n,observer:u}):s.push({defaultedQueryOptions:n,observer:new Z(i(this,E),n)})}),s},H=function(t,e){const s=i(this,p).indexOf(t);s!==-1&&(l(this,m,le(i(this,m),s,e)),g(this,c,z).call(this))},z=function(){var t;if(this.hasListeners()){const e=i(this,O),s=g(this,c,L).call(this,i(this,m),i(this,k)),o=g(this,c,P).call(this,s,(t=i(this,Q))==null?void 0:t.combine);e!==o&&A.batch(()=>{this.listeners.forEach(n=>{n(i(this,m))})})}},Y);function fe({queries:r,...t},e){const s=ee(),o=se(),n=re(),u=I.useMemo(()=>r.map(d=>{const D=s.defaultQueryOptions(d);return D._optimisticResults=o?"isRestoring":"optimistic",D}),[r,s,o]);u.forEach(d=>{oe(d),ne(d,n)}),ie(n);const[h]=I.useState(()=>new he(s,u,t)),[v,f,S]=h.getOptimisticResult(u,t.combine),a=!o&&t.subscribed!==!1;I.useSyncExternalStore(I.useCallback(d=>a?h.subscribe(A.batchCalls(d)):te,[h,a]),()=>h.getCurrentResult(),()=>h.getCurrentResult()),I.useEffect(()=>{h.setQueries(u,t)},[u,t,h]);const R=v.some((d,D)=>_(u[D],d))?v.flatMap((d,D)=>{const y=u[D];if(y){const U=new Z(s,y);if(_(y,d))return G(y,U,n);ae(d,o)&&G(y,U,n)}return[]}):[];if(R.length>0)throw Promise.all(R);const x=v.find((d,D)=>{const y=u[D];return y&&ue({result:d,errorResetBoundary:n,throwOnError:y.throwOnError,query:s.getQueryCache().get(y.queryHash),suspense:y.suspense})});if(x!=null&&x.error)throw x.error;return f(S())}function De(r,t){return fe({...r,queries:r.queries.map(e=>({...e,suspense:!0,throwOnError:ce,enabled:!0,placeholderData:void 0}))})}const K=r=>{let t;const e=new Set,s=(f,S)=>{const a=typeof f=="function"?f(t):f;if(!Object.is(a,t)){const C=t;t=S??(typeof a!="object"||a===null)?a:Object.assign({},t,a),e.forEach(R=>R(t,C))}},o=()=>t,h={setState:s,getState:o,getInitialState:()=>v,subscribe:f=>(e.add(f),()=>e.delete(f))},v=t=r(s,o,h);return h},de=r=>r?K(r):K,me=r=>r;function pe(r,t=me){const e=B.useSyncExternalStore(r.subscribe,B.useCallback(()=>t(r.getState()),[r,t]),B.useCallback(()=>t(r.getInitialState()),[r,t]));return B.useDebugValue(e),e}const T=r=>{const t=de(r),e=s=>pe(t,s);return Object.assign(e,t),e},be=r=>r?T(r):T,X={deliveryMethod:{pickup:!1,dropoff:!1},considerations:{resell:!1,faithBased:!1},itemCondition:{new:!1,used:!1},selectedItems:[],selectedCategories:[]},Oe=be((r,t)=>({formData:X,setDeliveryMethod:(e,s)=>r(o=>({formData:{...o.formData,deliveryMethod:{...o.formData.deliveryMethod,[e]:s}}})),setConsideration:(e,s)=>r(o=>({formData:{...o.formData,considerations:{...o.formData.considerations,[e]:s}}})),setItemCondition:(e,s)=>r(o=>({formData:{...o.formData,itemCondition:{...o.formData.itemCondition,[e]:s}}})),toggleItem:e=>r(s=>({formData:{...s.formData,selectedItems:s.formData.selectedItems.includes(e)?s.formData.selectedItems.filter(o=>o!==e):[...s.formData.selectedItems,e]}})),toggleCategory:e=>r(s=>({formData:{...s.formData,selectedCategories:s.formData.selectedCategories.includes(e)?s.formData.selectedCategories.filter(o=>o!==e):[...s.formData.selectedCategories,e]}})),selectAllCategories:e=>r(s=>({formData:{...s.formData,selectedCategories:s.formData.selectedCategories.length===e.length?[]:e}})),clearItems:()=>r(e=>({formData:{...e.formData,selectedItems:[]}})),resetAll:()=>r({formData:X}),isFormValid:()=>{const{formData:e}=t();return(e.deliveryMethod.pickup||e.deliveryMethod.dropoff)&&(e.itemCondition.new||e.itemCondition.used)&&e.selectedItems.length>0&&e.selectedCategories.length>0},setFormData:e=>r(s=>({formData:{...s.formData,...e}}))}));export{De as a,Oe as u};
